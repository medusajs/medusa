---
displayed_sidebar: servicesSidebar
---

import TypeList from "@site/src/components/TypeList"

# ReturnService

## constructor

### Parameters

<TypeList types={[{"name":"__namedParameters","type":"`InjectedDependencies`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="new ReturnService"/>

___

## Properties

<TypeList types={[{"name":"manager_","type":"`EntityManager`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"transactionManager_","type":"`undefined` \\| `EntityManager`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"__container__","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"totalsService_","type":"[TotalsService](services.TotalsService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"returnRepository_","type":"Repository&#60;[Return](../../entities/classes/entities.Return.mdx)&#62;","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"returnItemRepository_","type":"Repository&#60;[ReturnItem](../../entities/classes/entities.ReturnItem.mdx)&#62;","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"lineItemService_","type":"[LineItemService](services.LineItemService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"taxProviderService_","type":"[TaxProviderService](services.TaxProviderService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"shippingOptionService_","type":"[ShippingOptionService](services.ShippingOptionService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"fulfillmentProviderService_","type":"[FulfillmentProviderService](services.FulfillmentProviderService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"returnReasonService_","type":"[ReturnReasonService](services.ReturnReasonService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"orderService_","type":"[OrderService](services.OrderService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"productVariantInventoryService_","type":"[ProductVariantInventoryService](services.ProductVariantInventoryService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"featureFlagRouter_","type":"`FlagRouter`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"__configModule__","type":"`Record<string, unknown>`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"__moduleDeclaration__","type":"`Record<string, unknown>`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="ReturnService"/>

___

## Accessors

### activeManager\_

#### Returns

<TypeList types={[{"name":"EntityManager","type":"`EntityManager`","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="activeManager_"/>

___

## Methods

### withTransaction

#### Parameters

<TypeList types={[{"name":"transactionManager","type":"`EntityManager`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="withTransaction"/>

#### Returns

<TypeList types={[{"name":"this","type":"`this`","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="withTransaction"/>

### shouldRetryTransaction\_

#### Parameters

<TypeList types={[{"name":"err","type":"`Record<string, unknown>` \\| `object`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="shouldRetryTransaction_"/>

#### Returns

<TypeList types={[{"name":"boolean","type":"`boolean`","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="shouldRetryTransaction_"/>

### atomicPhase\_

Wraps some work within a transactional block. If the service already has
a transaction manager attached this will be reused, otherwise a new
transaction manager is created.

#### Type Parameters

<TypeList types={[{"name":"TResult","type":"`object`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"TError","type":"`object`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="atomicPhase_"/>

#### Parameters

<TypeList types={[{"name":"work","type":"(`transactionManager`: `EntityManager`) => Promise&#60;TResult&#62;","description":"the transactional work to be done","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"isolationOrErrorHandler","type":"`IsolationLevel` \\| (`error`: TError) => Promise&#60;void \\| TResult&#62;","description":"the isolation level to be used for the work.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"maybeErrorHandlerOrDontFail","type":"(`error`: TError) => Promise&#60;void \\| TResult&#62;","description":"Potential error handler","optional":true,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="atomicPhase_"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;TResult&#62;","optional":false,"defaultValue":"","description":"the result of the transactional work","expandable":false,"children":[]}]}  sectionTitle="atomicPhase_"/>

### getFulfillmentItems

Retrieves the order line items, given an array of items

#### Parameters

<TypeList types={[{"name":"order","type":"[Order](../../entities/classes/entities.Order.mdx)","description":"the order to get line items from","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"items","type":"[OrdersReturnItem](../../medusa/classes/medusa.OrdersReturnItem.mdx)[]","description":"the items to get","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"transformer","type":"`Transformer`","description":"a function to apply to each of the items\n   retrieved from the order, should return a line item. If the transformer\n   returns an undefined value the line item will be filtered from the\n   returned array.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="getFulfillmentItems"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[LineItem](../../entities/classes/entities.LineItem.mdx) & object[]&#62;","optional":false,"defaultValue":"","description":"the line items generated by the transformer.","expandable":false,"children":[]}]}  sectionTitle="getFulfillmentItems"/>

### list

#### Parameters

<TypeList types={[{"name":"selector","type":"[Selector](../../medusa/types/medusa.Selector.mdx)&#60;[Return](../../entities/classes/entities.Return.mdx)&#62;","description":"the query object for find","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"config","type":"[FindConfig](../../medusa/interfaces/medusa.FindConfig.mdx)&#60;[Return](../../entities/classes/entities.Return.mdx)&#62;","description":"the config object for find","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="list"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[Return](../../entities/classes/entities.Return.mdx)[]&#62;","optional":false,"defaultValue":"","description":"the result of the find operation","expandable":false,"children":[]}]}  sectionTitle="list"/>

### listAndCount

#### Parameters

<TypeList types={[{"name":"selector","type":"[Selector](../../medusa/types/medusa.Selector.mdx)&#60;[Return](../../entities/classes/entities.Return.mdx)&#62;","description":"the query object for find","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"config","type":"[FindConfig](../../medusa/interfaces/medusa.FindConfig.mdx)&#60;[Return](../../entities/classes/entities.Return.mdx)&#62;","description":"the config object for find","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="listAndCount"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[[Return](../../entities/classes/entities.Return.mdx)[], number]&#62;","optional":false,"defaultValue":"","description":"the result of the find operation","expandable":false,"children":[]}]}  sectionTitle="listAndCount"/>

### cancel

Cancels a return if possible. Returns can be canceled if it has not been received.

#### Parameters

<TypeList types={[{"name":"returnId","type":"`string`","description":"the id of the return to cancel.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="cancel"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[Return](../../entities/classes/entities.Return.mdx)&#62;","optional":false,"defaultValue":"","description":"the updated Return","expandable":false,"children":[]}]}  sectionTitle="cancel"/>

### validateReturnStatuses

Checks that an order has the statuses necessary to complete a return.
fulfillment\_status cannot be not\_fulfilled or returned.
payment\_status must be captured.

#### Parameters

<TypeList types={[{"name":"order","type":"[Order](../../entities/classes/entities.Order.mdx)","description":"the order to check statuses on","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="validateReturnStatuses"/>

#### Returns

<TypeList types={[{"name":"void","type":"`void`","optional":false,"defaultValue":"","description":"Checks that an order has the statuses necessary to complete a return.\nfulfillment\\_status cannot be not\\_fulfilled or returned.\npayment\\_status must be captured.","expandable":false,"children":[]}]}  sectionTitle="validateReturnStatuses"/>

#### Throws

when statuses are not sufficient for returns.

### validateReturnLineItem

Checks that a given quantity of a line item can be returned. Fails if the
item is undefined or if the returnable quantity of the item is lower, than
the quantity that is requested to be returned.

#### Parameters

<TypeList types={[{"name":"quantity","type":"`number`","description":"the quantity that is requested to be returned.","optional":false,"defaultValue":"0","expandable":false,"children":[]},{"name":"additional","type":"`object`","description":"the quantity that is requested to be returned.","optional":false,"defaultValue":"{}","expandable":false,"children":[]},{"name":"item","type":"[LineItem](../../entities/classes/entities.LineItem.mdx)","description":"the line item to check has sufficient returnable\n  quantity.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"additional.reason_id","type":"`string`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"additional.note","type":"`string`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="validateReturnLineItem"/>

#### Returns

<TypeList types={[{"name":"DeepPartial","type":"DeepPartial&#60;[LineItem](../../entities/classes/entities.LineItem.mdx)&#62;","optional":false,"defaultValue":"","description":"a line item where the quantity is set to the requested\n  return quantity.","expandable":false,"children":[]}]}  sectionTitle="validateReturnLineItem"/>

### retrieve

Retrieves a return by its id.

#### Parameters

<TypeList types={[{"name":"returnId","type":"`string`","description":"the id of the return to retrieve","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"config","type":"[FindConfig](../../medusa/interfaces/medusa.FindConfig.mdx)&#60;[Return](../../entities/classes/entities.Return.mdx)&#62;","description":"the config object","optional":false,"defaultValue":"{}","expandable":false,"children":[]}]}  sectionTitle="retrieve"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[Return](../../entities/classes/entities.Return.mdx)&#62;","optional":false,"defaultValue":"","description":"the return","expandable":false,"children":[]}]}  sectionTitle="retrieve"/>

### retrieveBySwap

#### Parameters

<TypeList types={[{"name":"swapId","type":"`string`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"relations","type":"`string`[]","description":"","optional":false,"defaultValue":"[]","expandable":false,"children":[]}]}  sectionTitle="retrieveBySwap"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[Return](../../entities/classes/entities.Return.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="retrieveBySwap"/>

### update

#### Parameters

<TypeList types={[{"name":"returnId","type":"`string`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"update","type":"`UpdateReturnInput`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="update"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[Return](../../entities/classes/entities.Return.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="update"/>

### create

Creates a return request for an order, with given items, and a shipping
method. If no refund amount is provided the refund amount is calculated from
the return lines and the shipping cost.

#### Parameters

<TypeList types={[{"name":"data","type":"`CreateReturnInput`","description":"data to use for the return e.g. shipping\\_method,\n   items or refund\\_amount","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="create"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[Return](../../entities/classes/entities.Return.mdx)&#62;","optional":false,"defaultValue":"","description":"the created return","expandable":false,"children":[]}]}  sectionTitle="create"/>

### fulfill

#### Parameters

<TypeList types={[{"name":"returnId","type":"`string`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="fulfill"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[Return](../../entities/classes/entities.Return.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="fulfill"/>

### receive

Registers a previously requested return as received. This will create a
refund to the customer. If the returned items don't match the requested
items the return status will be updated to requires\_action. This behaviour
is useful in situations where a custom refund amount is requested, but the
returned items are not matching the requested items. Setting the
allowMismatch argument to true, will process the return, ignoring any
mismatches.

#### Parameters

<TypeList types={[{"name":"returnId","type":"`string`","description":"the orderId to return to","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"receivedItems","type":"[OrdersReturnItem](../../medusa/classes/medusa.OrdersReturnItem.mdx)[]","description":"the items received after return.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"allowMismatch","type":"`boolean`","description":"whether to ignore return/received\nproduct mismatch","optional":false,"defaultValue":"false","expandable":false,"children":[]},{"name":"context","type":"`object`","description":"","optional":false,"defaultValue":"{}","expandable":false,"children":[]},{"name":"refundAmount","type":"`number`","description":"the amount to return","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"context.locationId","type":"`string`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="receive"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[Return](../../entities/classes/entities.Return.mdx)&#62;","optional":false,"defaultValue":"","description":"the result of the update operation","expandable":false,"children":[]}]}  sectionTitle="receive"/>
