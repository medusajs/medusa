---
displayed_sidebar: servicesSidebar
---

import TypeList from "@site/src/components/TypeList"

# ProductVariantInventoryService

## constructor

### Parameters

<TypeList types={[{"name":"__namedParameters","type":"`InjectedDependencies`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="new ProductVariantInventoryService"/>

___

## Properties

<TypeList types={[{"name":"__container__","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"manager_","type":"`EntityManager`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"transactionManager_","type":"`undefined` \\| `EntityManager`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"salesChannelLocationService_","type":"[SalesChannelLocationService](services.SalesChannelLocationService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"salesChannelInventoryService_","type":"[SalesChannelInventoryService](services.SalesChannelInventoryService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"productVariantService_","type":"[ProductVariantService](services.ProductVariantService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"eventBusService_","type":"[IEventBusService](../../types/EventBusTypes/interfaces/types.EventBusTypes.IEventBusService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"featureFlagRouter_","type":"`FlagRouter`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"remoteQuery_","type":"[RemoteQueryFunction](../../types/ModulesSdkTypes/types/types.ModulesSdkTypes.RemoteQueryFunction.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"__configModule__","type":"`Record<string, unknown>`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"__moduleDeclaration__","type":"`Record<string, unknown>`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="ProductVariantInventoryService"/>

___

## Accessors

### activeManager\_

#### Returns

<TypeList types={[{"name":"EntityManager","type":"`EntityManager`","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="activeManager_"/>

### inventoryService\_

#### Returns

<TypeList types={[{"name":"IInventoryService","type":"`object`","description":"The main service interface for the inventory module.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="inventoryService_"/>

### stockLocationService\_

#### Returns

<TypeList types={[{"name":"IStockLocationService","type":"`object`","description":"The main service interface for the stock location's module.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="stockLocationService_"/>

___

## Methods

### withTransaction

#### Parameters

<TypeList types={[{"name":"transactionManager","type":"`EntityManager`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="withTransaction"/>

#### Returns

<TypeList types={[{"name":"this","type":"`this`","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="withTransaction"/>

### shouldRetryTransaction\_

#### Parameters

<TypeList types={[{"name":"err","type":"`Record<string, unknown>` \\| `object`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="shouldRetryTransaction_"/>

#### Returns

<TypeList types={[{"name":"boolean","type":"`boolean`","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="shouldRetryTransaction_"/>

### atomicPhase\_

Wraps some work within a transactional block. If the service already has
a transaction manager attached this will be reused, otherwise a new
transaction manager is created.

#### Type Parameters

<TypeList types={[{"name":"TResult","type":"`object`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"TError","type":"`object`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="atomicPhase_"/>

#### Parameters

<TypeList types={[{"name":"work","type":"(`transactionManager`: `EntityManager`) => Promise&#60;TResult&#62;","description":"the transactional work to be done","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"isolationOrErrorHandler","type":"`IsolationLevel` \\| (`error`: TError) => Promise&#60;void \\| TResult&#62;","description":"the isolation level to be used for the work.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"maybeErrorHandlerOrDontFail","type":"(`error`: TError) => Promise&#60;void \\| TResult&#62;","description":"Potential error handler","optional":true,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="atomicPhase_"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;TResult&#62;","optional":false,"defaultValue":"","description":"the result of the transactional work","expandable":false,"children":[]}]}  sectionTitle="atomicPhase_"/>

### confirmInventory

confirms if requested inventory is available

#### Parameters

<TypeList types={[{"name":"variantId","type":"`string`","description":"id of the variant to confirm inventory for","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"quantity","type":"`number`","description":"quantity of inventory to confirm is available","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"`object`","description":"optionally include a sales channel if applicable","optional":false,"defaultValue":"{}","expandable":false,"children":[]},{"name":"context.salesChannelId","type":"`null` \\| `string`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="confirmInventory"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;Boolean&#62;","optional":false,"defaultValue":"","description":"boolean indicating if inventory is available","expandable":false,"children":[]}]}  sectionTitle="confirmInventory"/>

### retrieve

Retrieves a product variant inventory item by its inventory item ID and variant ID.

#### Parameters

<TypeList types={[{"name":"inventoryItemId","type":"`string`","description":"The ID of the inventory item to retrieve.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"variantId","type":"`string`","description":"The ID of the variant to retrieve.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="retrieve"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ProductVariantInventoryItem](../../entities/classes/entities.ProductVariantInventoryItem.mdx)&#62;","optional":false,"defaultValue":"","description":"A promise that resolves with the product variant inventory item.","expandable":false,"children":[]}]}  sectionTitle="retrieve"/>

### listByItem

list registered inventory items

#### Parameters

<TypeList types={[{"name":"itemIds","type":"`string`[]","description":"list inventory item ids","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="listByItem"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ProductVariantInventoryItem](../../entities/classes/entities.ProductVariantInventoryItem.mdx)[]&#62;","optional":false,"defaultValue":"","description":"list of inventory items","expandable":false,"children":[]}]}  sectionTitle="listByItem"/>

### listByVariant

List inventory items for a specific variant

#### Parameters

<TypeList types={[{"name":"variantId","type":"`string` \\| `string`[]","description":"variant id","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="listByVariant"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ProductVariantInventoryItem](../../entities/classes/entities.ProductVariantInventoryItem.mdx)[]&#62;","optional":false,"defaultValue":"","description":"variant inventory items for the variant id","expandable":false,"children":[]}]}  sectionTitle="listByVariant"/>

### listVariantsByItem

lists variant by inventory item id

#### Parameters

<TypeList types={[{"name":"itemId","type":"`string`","description":"item id","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="listVariantsByItem"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ProductVariant](../../entities/classes/entities.ProductVariant.mdx)[]&#62;","optional":false,"defaultValue":"","description":"a list of product variants that are associated with the item id","expandable":false,"children":[]}]}  sectionTitle="listVariantsByItem"/>

### listInventoryItemsByVariant

lists inventory items for a given variant

#### Parameters

<TypeList types={[{"name":"variantId","type":"`string`","description":"variant id","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="listInventoryItemsByVariant"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[InventoryItemDTO](../../medusa/types/medusa.InventoryItemDTO.mdx)[]&#62;","optional":false,"defaultValue":"","description":"lidt of inventory items for the variant","expandable":false,"children":[]}]}  sectionTitle="listInventoryItemsByVariant"/>

### attachInventoryItem

`**attachInventoryItem**(attachments): Promise&#60;[ProductVariantInventoryItem](../../entities/classes/entities.ProductVariantInventoryItem.mdx)[]&#62;`

Attach a variant to an inventory item

#### Parameters

<TypeList types={[{"name":"attachments","type":"`object`[]","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="attachInventoryItem"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ProductVariantInventoryItem](../../entities/classes/entities.ProductVariantInventoryItem.mdx)[]&#62;","optional":false,"defaultValue":"","description":"the variant inventory item","expandable":false,"children":[]}]}  sectionTitle="attachInventoryItem"/>

`**attachInventoryItem**(variantId, inventoryItemId, requiredQuantity?): Promise&#60;[ProductVariantInventoryItem](../../entities/classes/entities.ProductVariantInventoryItem.mdx)[]&#62;`

#### Parameters

<TypeList types={[{"name":"variantId","type":"`string`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"inventoryItemId","type":"`string`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"requiredQuantity","type":"`number`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="attachInventoryItem"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ProductVariantInventoryItem](../../entities/classes/entities.ProductVariantInventoryItem.mdx)[]&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="attachInventoryItem"/>

### detachInventoryItem

Remove a variant from an inventory item

#### Parameters

<TypeList types={[{"name":"inventoryItemId","type":"`string`","description":"inventory item id","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"variantId","type":"`string`","description":"variant id or undefined if all the variants will be affected","optional":true,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="detachInventoryItem"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;void&#62;","optional":false,"defaultValue":"","description":"Remove a variant from an inventory item","expandable":false,"children":[]}]}  sectionTitle="detachInventoryItem"/>

### reserveQuantity

Reserves a quantity of a variant

#### Parameters

<TypeList types={[{"name":"variantId","type":"`string`","description":"variant id","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"quantity","type":"`number`","description":"quantity to reserve","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"context","type":"`ReserveQuantityContext`","description":"optional parameters","optional":false,"defaultValue":"{}","expandable":false,"children":[]}]}  sectionTitle="reserveQuantity"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;void \\| [ReservationItemDTO](../../medusa/types/medusa.ReservationItemDTO.mdx)[]&#62;","optional":false,"defaultValue":"","description":"Reserves a quantity of a variant","expandable":false,"children":[]}]}  sectionTitle="reserveQuantity"/>

### adjustReservationsQuantityByLineItem

Adjusts the quantity of reservations for a line item by a given amount.

#### Parameters

<TypeList types={[{"name":"lineItemId","type":"`string`","description":"The ID of the line item","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"variantId","type":"`string`","description":"The ID of the variant","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"locationId","type":"`string`","description":"The ID of the location to prefer adjusting quantities at","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"quantity","type":"`number`","description":"The amount to adjust the quantity by","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="adjustReservationsQuantityByLineItem"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;void&#62;","optional":false,"defaultValue":"","description":"Adjusts the quantity of reservations for a line item by a given amount.","expandable":false,"children":[]}]}  sectionTitle="adjustReservationsQuantityByLineItem"/>

### validateInventoryAtLocation

Validate stock at a location for fulfillment items

#### Parameters

<TypeList types={[{"name":"items","type":"Omit&#60;[LineItem](../../entities/classes/entities.LineItem.mdx), \"beforeInsert\"&#62;[]","description":"Fulfillment Line items to validate quantities for","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"locationId","type":"`string`","description":"Location to validate stock at","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="validateInventoryAtLocation"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;void&#62;","optional":false,"defaultValue":"","description":"nothing if successful, throws error if not","expandable":false,"children":[]}]}  sectionTitle="validateInventoryAtLocation"/>

### deleteReservationsByLineItem

delete a reservation of variant quantity

#### Parameters

<TypeList types={[{"name":"lineItemId","type":"`string` \\| `string`[]","description":"line item id","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"variantId","type":"`string`","description":"variant id","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"quantity","type":"`number`","description":"quantity to release","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="deleteReservationsByLineItem"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;void&#62;","optional":false,"defaultValue":"","description":"delete a reservation of variant quantity","expandable":false,"children":[]}]}  sectionTitle="deleteReservationsByLineItem"/>

### adjustInventory

Adjusts inventory of a variant on a location

#### Parameters

<TypeList types={[{"name":"variantId","type":"`string`","description":"variant id","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"locationId","type":"`string`","description":"location id","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"quantity","type":"`number`","description":"quantity to adjust","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="adjustInventory"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;void&#62;","optional":false,"defaultValue":"","description":"Adjusts inventory of a variant on a location","expandable":false,"children":[]}]}  sectionTitle="adjustInventory"/>

### setVariantAvailability

#### Parameters

<TypeList types={[{"name":"variants","type":"[ProductVariant](../../entities/classes/entities.ProductVariant.mdx)[] \\| [PricedVariant](../../medusa/types/medusa.PricedVariant.mdx)[]","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"salesChannelId","type":"`undefined` \\| `string` \\| `string`[]","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"availabilityContext","type":"`AvailabilityContext`","description":"","optional":false,"defaultValue":"{}","expandable":false,"children":[]}]}  sectionTitle="setVariantAvailability"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ProductVariant](../../entities/classes/entities.ProductVariant.mdx)[] \\| [PricedVariant](../../medusa/types/medusa.PricedVariant.mdx)[]&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="setVariantAvailability"/>

### getAvailabilityContext

#### Parameters

<TypeList types={[{"name":"variants","type":"`string`[]","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"salesChannelId","type":"`undefined` \\| `string` \\| `string`[]","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"existingContext","type":"`AvailabilityContext`","description":"","optional":false,"defaultValue":"{}","expandable":false,"children":[]}]}  sectionTitle="getAvailabilityContext"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;Required&#60;AvailabilityContext&#62;&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="getAvailabilityContext"/>

### setProductAvailability

#### Parameters

<TypeList types={[{"name":"products","type":"([Product](../../entities/classes/entities.Product.mdx) \\| [PricedProduct](../../medusa/types/medusa.PricedProduct.mdx))[]","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"salesChannelId","type":"`undefined` \\| `string` \\| `string`[]","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="setProductAvailability"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;([Product](../../entities/classes/entities.Product.mdx) \\| [PricedProduct](../../medusa/types/medusa.PricedProduct.mdx))[]&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="setProductAvailability"/>

### getVariantQuantityFromVariantInventoryItems

Get the quantity of a variant from a list of variantInventoryItems
The inventory quantity of the variant should be equal to the inventory
item with the smallest stock, adjusted for quantity required to fulfill
the given variant.

#### Parameters

<TypeList types={[{"name":"variantInventoryItems","type":"[ProductVariantInventoryItem](../../entities/classes/entities.ProductVariantInventoryItem.mdx)[]","description":"List of inventoryItems for a given variant, These must all be for the same variant","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"channelId","type":"`string`","description":"Sales channel id to fetch availability for","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="getVariantQuantityFromVariantInventoryItems"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;number&#62;","optional":false,"defaultValue":"","description":"The available quantity of the variant from the inventoryItems","expandable":false,"children":[]}]}  sectionTitle="getVariantQuantityFromVariantInventoryItems"/>
