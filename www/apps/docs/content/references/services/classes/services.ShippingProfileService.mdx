---
displayed_sidebar: servicesSidebar
---

import TypeList from "@site/src/components/TypeList"

# ShippingProfileService

Provides layer to manipulate profiles.

## Implements

## constructor

### Parameters

<TypeList types={[{"name":"__namedParameters","type":"`InjectedDependencies`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="new ShippingProfileService"/>

___

## Properties

<TypeList types={[{"name":"manager_","type":"`EntityManager`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"transactionManager_","type":"`undefined` \\| `EntityManager`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"__container__","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"productService_","type":"[ProductService](services.ProductService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"shippingOptionService_","type":"[ShippingOptionService](services.ShippingOptionService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"customShippingOptionService_","type":"[CustomShippingOptionService](services.CustomShippingOptionService.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"shippingProfileRepository_","type":"Repository&#60;[ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62; & `object`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"productRepository_","type":"Repository&#60;[Product](../../entities/classes/entities.Product.mdx)&#62; & `object`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"featureFlagRouter_","type":"`FlagRouter`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"__configModule__","type":"`Record<string, unknown>`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"__moduleDeclaration__","type":"`Record<string, unknown>`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="ShippingProfileService"/>

___

## Accessors

### activeManager\_

#### Returns

<TypeList types={[{"name":"EntityManager","type":"`EntityManager`","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="activeManager_"/>

___

## Methods

### withTransaction

#### Parameters

<TypeList types={[{"name":"transactionManager","type":"`EntityManager`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="withTransaction"/>

#### Returns

<TypeList types={[{"name":"this","type":"`this`","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="withTransaction"/>

### shouldRetryTransaction\_

#### Parameters

<TypeList types={[{"name":"err","type":"`Record<string, unknown>` \\| `object`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="shouldRetryTransaction_"/>

#### Returns

<TypeList types={[{"name":"boolean","type":"`boolean`","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="shouldRetryTransaction_"/>

### atomicPhase\_

Wraps some work within a transactional block. If the service already has
a transaction manager attached this will be reused, otherwise a new
transaction manager is created.

#### Type Parameters

<TypeList types={[{"name":"TResult","type":"`object`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"TError","type":"`object`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="atomicPhase_"/>

#### Parameters

<TypeList types={[{"name":"work","type":"(`transactionManager`: `EntityManager`) => Promise&#60;TResult&#62;","description":"the transactional work to be done","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"isolationOrErrorHandler","type":"`IsolationLevel` \\| (`error`: TError) => Promise&#60;void \\| TResult&#62;","description":"the isolation level to be used for the work.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"maybeErrorHandlerOrDontFail","type":"(`error`: TError) => Promise&#60;void \\| TResult&#62;","description":"Potential error handler","optional":true,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="atomicPhase_"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;TResult&#62;","optional":false,"defaultValue":"","description":"the result of the transactional work","expandable":false,"children":[]}]}  sectionTitle="atomicPhase_"/>

### list

#### Parameters

<TypeList types={[{"name":"selector","type":"[Selector](../../medusa/types/medusa.Selector.mdx)&#60;[ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62;","description":"the query object for find","optional":false,"defaultValue":"{}","expandable":false,"children":[]},{"name":"config","type":"[FindConfig](../../medusa/interfaces/medusa.FindConfig.mdx)&#60;[ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62;","description":"the config object for find","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="list"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)[]&#62;","optional":false,"defaultValue":"","description":"the result of the find operation","expandable":false,"children":[]}]}  sectionTitle="list"/>

### getMapProfileIdsByProductIds

#### Parameters

<TypeList types={[{"name":"productIds","type":"`string`[]","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="getMapProfileIdsByProductIds"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;Map&#60;string, string&#62;&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="getMapProfileIdsByProductIds"/>

### retrieve

Gets a profile by id.
Throws in case of DB Error and if profile was not found.

#### Parameters

<TypeList types={[{"name":"profileId","type":"`string`","description":"the id of the profile to get.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"options","type":"[FindConfig](../../medusa/interfaces/medusa.FindConfig.mdx)&#60;[ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62;","description":"options opf the query.","optional":false,"defaultValue":"{}","expandable":false,"children":[]}]}  sectionTitle="retrieve"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62;","optional":false,"defaultValue":"","description":"the profile document.","expandable":false,"children":[]}]}  sectionTitle="retrieve"/>

### retrieveForProducts

#### Parameters

<TypeList types={[{"name":"productIds","type":"`string` \\| `string`[]","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="retrieveForProducts"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;object&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="retrieveForProducts"/>

### retrieveDefault

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;null \\| [ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="retrieveDefault"/>

### createDefault

Creates a default shipping profile, if this does not already exist.

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62;","optional":false,"defaultValue":"","description":"the shipping profile","expandable":false,"children":[]}]}  sectionTitle="createDefault"/>

### retrieveGiftCardDefault

Retrieves the default gift card profile

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;null \\| [ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62;","optional":false,"defaultValue":"","description":"the shipping profile for gift cards","expandable":false,"children":[]}]}  sectionTitle="retrieveGiftCardDefault"/>

### createGiftCardDefault

Creates a default shipping profile, for gift cards if unless it already
exists.

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62;","optional":false,"defaultValue":"","description":"the shipping profile","expandable":false,"children":[]}]}  sectionTitle="createGiftCardDefault"/>

### create

Creates a new shipping profile.

#### Parameters

<TypeList types={[{"name":"profile","type":"`CreateShippingProfile`","description":"the shipping profile to create from","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="create"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62;","optional":false,"defaultValue":"","description":"the result of the create operation","expandable":false,"children":[]}]}  sectionTitle="create"/>

### update

Updates a profile. Metadata updates and product updates should use
dedicated methods, e.g. `setMetadata`, `addProduct`, etc. The function
will throw errors if metadata or product updates are attempted.

#### Parameters

<TypeList types={[{"name":"profileId","type":"`string`","description":"the id of the profile. Must be a string that\n  can be casted to an ObjectId","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"update","type":"`UpdateShippingProfile`","description":"an object with the update values.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="update"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62;","optional":false,"defaultValue":"","description":"resolves to the update result.","expandable":false,"children":[]}]}  sectionTitle="update"/>

### delete

Deletes a profile with a given profile id.

#### Parameters

<TypeList types={[{"name":"profileId","type":"`string`","description":"the id of the profile to delete. Must be\n  castable as an ObjectId","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="delete"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;void&#62;","optional":false,"defaultValue":"","description":"the result of the delete operation.","expandable":false,"children":[]}]}  sectionTitle="delete"/>

### addProduct

#### Parameters

<TypeList types={[{"name":"profileId","type":"`string`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"productId","type":"`string` \\| `string`[]","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="addProduct"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62;","optional":false,"defaultValue":"","description":"","expandable":false,"children":[]}]}  sectionTitle="addProduct"/>

#### Deprecated

use [addProducts](services.ShippingProfileService.mdx#addproducts) instead

### addProducts

Adds a product or an array of products to the profile.

#### Parameters

<TypeList types={[{"name":"profileId","type":"`string`","description":"the profile to add the products to.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"productId","type":"`string` \\| `string`[]","description":"the ID of the product or multiple products to add.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="addProducts"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62;","optional":false,"defaultValue":"","description":"the result of update","expandable":false,"children":[]}]}  sectionTitle="addProducts"/>

### removeProducts

Removes a product or an array of products from the profile.

#### Parameters

<TypeList types={[{"name":"profileId","type":"`null` \\| `string`","description":"the profile to add the products to.","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"productId","type":"`string` \\| `string`[]","description":"the ID of the product or multiple products to add.","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="removeProducts"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;void \\| [ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62;","optional":false,"defaultValue":"","description":"the result of update","expandable":false,"children":[]}]}  sectionTitle="removeProducts"/>

### addShippingOption

Adds a shipping option to the profile. The shipping option can be used to
fulfill the products in the products field.

#### Parameters

<TypeList types={[{"name":"profileId","type":"`string`","description":"the profile to apply the shipping option to","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"optionId","type":"`string` \\| `string`[]","description":"the ID of the option or multiple options to add to the profile","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="addShippingOption"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ShippingProfile](../../entities/classes/entities.ShippingProfile.mdx)&#62;","optional":false,"defaultValue":"","description":"the result of the model update operation","expandable":false,"children":[]}]}  sectionTitle="addShippingOption"/>

### fetchCartOptions

Finds all the shipping profiles that cover the products in a cart, and
validates all options that are available for the cart.

#### Parameters

<TypeList types={[{"name":"cart","type":"`any`","description":"the cart object to find shipping options for","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="fetchCartOptions"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;[ShippingOption](../../entities/classes/entities.ShippingOption.mdx)[]&#62;","optional":false,"defaultValue":"","description":"a list of the available shipping options","expandable":false,"children":[]}]}  sectionTitle="fetchCartOptions"/>

### getProfilesInCart

Returns a list of all the productIds in the cart.

#### Parameters

<TypeList types={[{"name":"cart","type":"[Cart](../../entities/classes/entities.Cart.mdx)","description":"the cart to extract products from","optional":false,"defaultValue":"","expandable":false,"children":[]}]}  sectionTitle="getProfilesInCart"/>

#### Returns

<TypeList types={[{"name":"Promise","type":"Promise&#60;string[]&#62;","optional":false,"defaultValue":"","description":"a list of product ids","expandable":false,"children":[]}]}  sectionTitle="getProfilesInCart"/>
